language: python
dist: trusty
git:
  depth: 10

cache:
  apt: true
  directories:
  - ${HOME}/.smt_solvers/btor
  - ${HOME}/.smt_solvers/bdd
  - ${HOME}/.cache/pip
  - ${HOME}/python_bindings/all
  - ${HOME}/python_bindings/msat
  - ${HOME}/python_bindings/z3
  - ${HOME}/python_bindings/cvc4
  - ${HOME}/python_bindings/yices
  - ${HOME}/python_bindings/bdd
  - ${HOME}/python_bindings/picosat
  - ${HOME}/python_bindings/btor

addons:
  apt:
    packages:
    - python-setuptools
    - python-nose
    - python-pip
    - python-dev
    - make
    - build-essential
    - swig
    - libgmp-dev
    - autoconf
    - libtool
    - wget
    - curl
    - libboost-dev
    - python3-all-dev

python:
  - 3.5
  - 2.7
  - pypy


# Multiple envs will cause multiple build across multiple python versions.
# We test the following:
# 1. PySMT w/o solvers
# 2. PySMT with one solver at the time
#
env:
  matrix:
    - PYSMT_SOLVER="all"
    - PYSMT_SOLVER="None"
    - PYSMT_SOLVER="msat"
    - PYSMT_SOLVER="z3"
    - PYSMT_SOLVER="cvc4"
    - PYSMT_SOLVER="yices"
    - PYSMT_SOLVER="bdd"
    - PYSMT_SOLVER="picosat"
    - PYSMT_SOLVER="btor"
    - PYSMT_SOLVER="msat_wrap"
    - PYSMT_SOLVER="z3_wrap"

matrix:
  fast_finish: true

  exclude:
    - python: pypy
      env: PYSMT_SOLVER="msat"
    - python: pypy
      env: PYSMT_SOLVER="z3"
    - python: pypy
      env: PYSMT_SOLVER="cvc4"
    - python: pypy
      env: PYSMT_SOLVER="yices"
    - python: pypy
      env: PYSMT_SOLVER="bdd"
    - python: pypy
      env: PYSMT_SOLVER="picosat"
    - python: pypy
      env: PYSMT_SOLVER="btor"
    - python: pypy
      env: PYSMT_SOLVER="all"

install:
  - "./ci/travis_install.sh"

script:
  - "./ci/travis_script.sh"
